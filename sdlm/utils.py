"""Defines the utilities used during the training/infernece of diffusion language models."""
import torch.nn.functional as F


def convert_to_simplex(token_ids, simplex_value, vocab_size):
    return 2 * simplex_value * F.one_hot(token_ids, vocab_size) - simplex_value


def scale(inputs, scale_value):
    return inputs / scale_value
